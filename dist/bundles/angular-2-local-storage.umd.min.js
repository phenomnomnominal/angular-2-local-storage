!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("angular-2-local-storage",["exports","@angular/core","rxjs","rxjs/operators"],t):t((e=e||self)["angular-2-local-storage"]={},e.ng.core,e.rxjs,e.rxjs.operators)}(this,(function(e,t,r,s){"use strict";var i=new t.InjectionToken("LOCAL_STORAGE_SERVICE_CONFIG"),o=function(){function e(){}return e.forRoot=function(t){return void 0===t&&(t={}),{ngModule:e,providers:[{provide:i,useValue:t}]}},e}();o.decorators=[{type:t.NgModule}];var n=function(){function e(e){var t=this;void 0===e&&(e={}),this.isSupported=!1,this.notifyOptions={setItem:!1,removeItem:!1},this.prefix="ls",this.storageType="localStorage",this.errors=new r.Subscriber,this.removeItems=new r.Subscriber,this.setItems=new r.Subscriber,this.warnings=new r.Subscriber;var i=e.notifyOptions,o=e.prefix,n=e.storageType;if(null!=i){var a=i.setItem,p=i.removeItem;this.setNotify(!!a,!!p)}null!=o&&this.setPrefix(o),null!=n&&this.setStorageType(n),this.errors$=new r.Observable((function(e){return t.errors=e})).pipe(s.share()),this.removeItems$=new r.Observable((function(e){return t.removeItems=e})).pipe(s.share()),this.setItems$=new r.Observable((function(e){return t.setItems=e})).pipe(s.share()),this.warnings$=new r.Observable((function(e){return t.warnings=e})).pipe(s.share()),this.isSupported=this.checkSupport()}return e.prototype.add=function(e,t){return console&&console.warn&&(console.warn("This function is deprecated."),console.warn("Use `LocalStorageService.set` instead.")),this.set(e,t)},e.prototype.clearAll=function(e){var t=this.prefix?new RegExp("^"+this.prefix):new RegExp(""),r=e?new RegExp(e):new RegExp("");if(!this.isSupported)return this.warnings.next("LOCAL_STORAGE_NOT_SUPPORTED"),!1;var s=this.prefix.length;for(var i in this.webStorage)if(t.test(i)&&r.test(i.substr(s)))try{this.remove(i.substr(s))}catch(e){return this.errors.next(e.message),!1}return!0},e.prototype.deriveKey=function(e){return""+this.prefix+e},e.prototype.get=function(e){if(!this.isSupported)return this.warnings.next("LOCAL_STORAGE_NOT_SUPPORTED"),null;var t=this.webStorage?this.webStorage.getItem(this.deriveKey(e)):null;if(!t||"null"===t)return null;try{return JSON.parse(t)}catch(e){return null}},e.prototype.getStorageType=function(){return this.storageType},e.prototype.keys=function(){if(!this.isSupported)return this.warnings.next("LOCAL_STORAGE_NOT_SUPPORTED"),[];var e=this.prefix.length,t=[];for(var r in this.webStorage)if(r.substr(0,e)===this.prefix)try{t.push(r.substr(e))}catch(e){return this.errors.next(e.message),[]}return t},e.prototype.length=function(){for(var e=0,t=this.webStorage,r=0;r<t.length;r++)0===t.key(r).indexOf(this.prefix)&&(e+=1);return e},e.prototype.remove=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var s=!0;return t.forEach((function(t){e.isSupported||(e.warnings.next("LOCAL_STORAGE_NOT_SUPPORTED"),s=!1);try{e.webStorage.removeItem(e.deriveKey(t)),e.notifyOptions.removeItem&&e.removeItems.next({key:t,storageType:e.storageType})}catch(t){e.errors.next(t.message),s=!1}})),s},e.prototype.set=function(e,t){if(t=void 0===t?null:JSON.stringify(t),!this.isSupported)return this.warnings.next("LOCAL_STORAGE_NOT_SUPPORTED"),!1;try{this.webStorage&&this.webStorage.setItem(this.deriveKey(e),t),this.notifyOptions.setItem&&this.setItems.next({key:e,newvalue:t,storageType:this.storageType})}catch(e){return this.errors.next(e.message),!1}return!0},e.prototype.checkSupport=function(){try{var e=this.storageType in window&&null!==window[this.storageType];if(e){this.webStorage=window[this.storageType];var t=this.deriveKey("__"+Math.round(1e7*Math.random()));this.webStorage.setItem(t,""),this.webStorage.removeItem(t)}return e}catch(e){return this.errors.next(e.message),!1}},e.prototype.setPrefix=function(e){this.prefix=e;this.prefix&&!this.prefix.endsWith(".")&&(this.prefix=this.prefix?this.prefix+".":"")},e.prototype.setStorageType=function(e){this.storageType=e},e.prototype.setNotify=function(e,t){null!=e&&(this.notifyOptions.setItem=e),null!=t&&(this.notifyOptions.removeItem=t)},e}();n.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new n(t.ɵɵinject(i,8))},token:n,providedIn:"root"}),n.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],n.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Optional},{type:t.Inject,args:[i]}]}]},e.LocalStorageModule=o,e.LocalStorageService=n,e.ɵa=i,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-2-local-storage.umd.min.js.map